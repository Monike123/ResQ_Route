""# Admin Dashboard Specification: Safe Route App

This document outlines the specifications for the Admin Dashboard, a web-based interface designed for administrators to manage, monitor, and moderate the Safe Route App ecosystem. It covers admin roles, permissions, key functionalities, and workflows for maintaining the platform
## 1. Admin Roles

The Admin Dashboard supports various roles with distinct levels of access and permissions, ensuring a clear separation of duties and adherence to the principle of least privilege.

*   **Super Admin**: Full access to all features, including user management, role assignment, system configuration, and data oversight. Responsible for overall platform governance.
*   **Moderator**: Focuses on content moderation, such as reviewing user flags, verifying unsafe zones, and managing feedback. Limited access to user PII.
*   **Support Agent**: Provides user support, with read-only access to journey history, reports, and user profiles (excluding sensitive PII). Cannot modify system settings or user data.
*   **Data Analyst**: Access to anonymized or aggregated data for generating reports and insights into platform usage and safety trends. No access to individual user PII.

## 2. Permissions Matrix

| Feature / Action        | Super Admin | Moderator | Support Agent | Data Analyst |
| :---------------------- | :---------- | :-------- | :------------ | :----------- |
| User Management         | ✅          | ❌        | ❌            | ❌           |
| Admin Role Management   | ✅          | ❌        | ❌            | ❌           |
| Unsafe Zone Approval    | ✅          | ✅        | ❌            | ❌           |
| Flag Dispute Resolution | ✅          | ✅        | ❌            | ❌           |
| Crime Data Ingestion    | ✅          | ❌        | ❌            | ❌           |
| Report Review           | ✅          | ✅        | ✅ (Read-only) | ❌           |
| Analytics Dashboard     | ✅          | ❌        | ❌            | ✅           |
| Safety Score Tuning     | ✅          | ❌        | ❌            | ❌           |
| System Configuration    | ✅          | ❌        | ❌            | ❌           |
| View Audit Logs         | ✅          | ❌        | ❌            | ❌           |

## 3. Unsafe Zone Approval Flow

User-flagged unsafe areas undergo a structured approval process to ensure accuracy and prevent misuse.

1.  **User Submission**: A user flags an unsafe area via the mobile app, providing location, reason, and optional photo.
2.  **Pending Review**: The flag is stored in the `unsafe_zones` table with `verified = FALSE` and enters a pending review queue in the Admin Dashboard.
3.  **Moderator Review**: A Moderator accesses the flag, reviews the details, associated photos, and potentially cross-references with other data sources (e.g., crime data, other user flags).
4.  **Action**: The Moderator can:
    *   **Approve**: Mark the `unsafe_zone` as `verified = TRUE`, making it visible to all users on the map and influencing route safety scores.
    *   **Reject**: Discard the flag if deemed invalid or false.
    *   **Request More Info**: Contact the user for further details.
    *   **Merge**: Merge with an existing unsafe zone if it represents the same incident.
5.  **AI Threshold**: If multiple users flag the same spot within a short period, an AI threshold might automatically mark it as `verified = TRUE` with a `low` confidence score, prompting a Moderator to review and potentially increase the confidence.

## 4. Flag Dispute Resolution

Users can dispute existing unsafe zone flags, initiating a resolution process.

1.  **User Dispute**: A user submits a dispute against an existing unsafe zone, providing reasons.
2.  **Moderator Assignment**: The dispute is assigned to a Moderator.
3.  **Investigation**: The Moderator investigates the dispute, reviewing the original flag, the dispute details, and any new evidence.
4.  **Resolution**: The Moderator can:
    *   **Uphold Flag**: Maintain the existing unsafe zone status.
    *   **Remove Flag**: Delete the unsafe zone if the dispute is valid.
    *   **Adjust Severity**: Modify the severity score or decay coefficient of the unsafe zone.
    *   **Update Reason**: Edit the description of the unsafe zone.

## 5. Crime Data Ingestion Process

Administrators are responsible for importing and managing external crime data sources.

1.  **Source Identification**: Identify reliable sources of crime data (e.g., government police reports, public datasets).
2.  **Data Extraction/Transformation**: Develop scripts or use tools to extract and transform raw crime data into a standardized format compatible with the `crime_data` table schema.
3.  **Import**: Use the Admin Dashboard to upload or trigger an automated import of the processed crime data.
4.  **AI Aggregation**: The AI Crime Analysis Service processes the newly ingested data to identify patterns and update risk assessments.
5.  **Verification**: Periodically verify the accuracy and relevance of ingested crime data.

## 6. Report Review System

Administrators can review generated Safe Route Reports for auditing, quality assurance, and legal compliance.

1.  **Search/Filter**: Admins can search and filter reports by user, journey ID, date range, or status.
2.  **View Report**: Access the full PDF report, including all journey details, safety diagnostics, and SOS logs.
3.  **Verify Integrity**: Option to re-calculate the digital integrity hash of a report to ensure it has not been tampered with.
4.  **Audit Trail**: View an audit trail of who accessed or shared a specific report.

## 7. Analytics Metrics

The Admin Dashboard provides key analytics and metrics to monitor platform health, user behavior, and safety trends.

*   **User Growth**: New registrations, active users, churn rate.
*   **Journey Statistics**: Total journeys, average journey duration, distance covered.
*   **Safety Metrics**: Average safety score, number of SOS triggers, false positive rate for SOS, number of unsafe zones flagged/verified.
*   **AI Performance**: AI API usage, cost, accuracy of crime analysis.
*   **System Performance**: API response times, error rates, server load.

## 8. Safety Score Tuning Panel

Super Admins have access to a dedicated panel for fine-tuning the safety scoring algorithm.

*   **Weight Adjustment**: Adjust the weights of different factors (e.g., Crime Density Weight, User Flag Weight, Commercial Factor, Lighting Factor) in the safety scoring formula.
*   **Decay Coefficient**: Modify the decay coefficient for unsafe zones to control how quickly their severity diminishes over time.
*   **Threshold Configuration**: Adjust thresholds for stationary deadman switch, route deviation, and AI-based auto-verification.
*   **Simulation & Testing**: Run simulations with new parameters to observe their impact on safety scores before deploying changes to production.
